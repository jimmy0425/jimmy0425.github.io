/* =========================================
   1. 글로벌 리셋 & 모바일 터치 하이라이트 방지
   ========================================= */
/* 네이버 웨일, iOS 사파리 등에서 터치 시 강제로 생기는 회색/초록색 박스 제거 */
* {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0) !important;
  -webkit-touch-callout: none !important; /* 이미지 길게 누름 메뉴 방지 */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  text-rendering: geometricPrecision;
  outline: none; /* 포커스 테두리 제거 */
}

body {
  margin: 0;
  font-family: -apple-system, "Noto Sans KR", "Noto Sans JP", sans-serif;
  background-color: #000;
}


/* =========================================
   2. 드래그 방지 및 허용 설정
   ========================================= */
/* 기본적으로 모든 요소 드래그/선택 방지 (이미지 보호) */
body, 
#viewer-container, 
img, 
.webtoon-img {
  user-select: none;
  -webkit-user-select: none;
  -webkit-user-drag: none;
}

/* 텍스트 박스는 드래그 가능하게 예외 처리 */
.line-box {
  user-select: text;
  -webkit-user-select: text;
  cursor: text;
}

/* =========================================
   3. 뷰어 및 레이어 구조
   ========================================= */
#viewer-container {
  position: relative;
  width: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

#viewer,
.webtoon-img {
  display: block;
  margin: 0 auto;
  object-fit: contain;
}

/* 오버레이 컨테이너 (이벤트 통과) */
#overlay-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 15;
}

/* Layer 1: 배경 레이어 (클릭 불가) */
#bg-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

/* Layer 2: 텍스트 레이어 (껍데기는 통과, 내용은 반응) */
#text-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none; 
  z-index: 2;
}

/* =========================================
   4. 텍스트 박스 디자인 (핵심)
   ========================================= */
/* 개별 라인 박스 (글자 레이어) */
.line-box {
  position: absolute;
  display: block;
  box-sizing: border-box;
  overflow: visible;
  line-height: 1.0;
  white-space: nowrap;
  font-weight: bold;

  /* ✅ 추가: 배경색이 글자에 너무 딱 붙지 않게 여백 추가 */
  padding: 2px 4px;        /* 상하 2px, 좌우 4px */
  
  pointer-events: auto; /* 마우스 이벤트 받음 */
}

/* =========================================
   4-1. 번역 보기 전용(줄바꿈 허용)
   ========================================= */
.line-box.translated {
  white-space: normal !important;
  word-break: break-all !important; /*이건 절대 바꾸면 안됨*/
  line-height: 1.0 !important;  
}

.line-box.vertical {
  writing-mode: vertical-rl; 
}



/* 배경 박스 (회색 배경) */
.bg-box {
  position: absolute;
  background-color: #e2e2e2;
  border-radius: 3px;
}

/* 1. 기본 상태에서 클릭했을 때 */
/* .line-box.selected {
  background-color: #e2e2e2;  
  color: #000000 !important;
  opacity: 1 !important;
  z-index: 100;
  cursor: pointer;
} */

/* ✅ 2. [핵심 수정] 숨김 모드(.hide-mode)일 때도 선택되면 글자가 보여야 함! */
/* 이 부분이 없어서 투명색으로 남았던 것입니다. */
.hide-mode .line-box.selected {
  background-color: #e2e2e2;      /* 배경 회색 */
  color: #000000 !important;     /* 글자 검은색 강제 (투명 덮어쓰기) */
  opacity: 1 !important;         /* 불투명하게 */
}

/* 드래그해서 선택 시 노란색 하이라이트 */
.line-box::selection {
  background-color: rgba(255, 235, 59, 1.0); 
  color: #000 !important;
} 
.hide-mode .line-box::selection {
  background-color: rgba(255, 235, 59, 1.0);
  color: #000 !important;
}

/* 호버 효과(Hover)는 마우스가 있는 장치에서만 작동하도록 제한 */
@media (hover: hover) {
  /* 숨김 모드 호버: 해당 줄만 보이기 */
  .hide-mode .line-box:hover {
    background-color: #e2e2e2;
    color: #000 !important;
    border-radius: 3px;
    box-shadow: 0 0 5px rgba(0,0,0,0.2);
    z-index: 100;
    cursor: pointer;
  }
}

/* =========================================
   5. 숨김 모드 (Hide Mode) 동작
   ========================================= */
/* 배경 레이어 숨김 */
.hide-mode #bg-layer {
  opacity: 0;
  transition: opacity 0.2s; 
}

/* 텍스트 투명화 */
.hide-mode .line-box {
  color: transparent !important; 
  transition: color 0.1s, background-color 0.1s;
}

/* 상호작용 차단 (투명도가 0일 때 JS에서 추가하는 클래스용) */
#text-layer.no-interaction .line-box {
  pointer-events: none !important;
}

/* =========================================
   6. UI 컨트롤 (버튼, 네비게이션)
   ========================================= */
/* 페이지 이동 네비게이션 */
.page-nav {
  background: #f0f0f0;
  padding: 5px;
  border-radius: 5px;
}

/* 클릭 영역 (좌우) */
.click-zone {
  position: fixed;
  top: 0;
  bottom: 0;
  width: 15%;
  background-color: gray;
  opacity: 0;
  z-index: 10;
}
#click-left { left: 0; }
#click-right { right: 0; }

/* 좌측 컨트롤 바 */
.controls {
  position: fixed;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 10px;
  background: rgba(255, 255, 255, 0.9);
  width: 180px;
  box-sizing: border-box;
  z-index: 20;
}
.controls button {
  width: 100%;
  box-sizing: border-box;
  font-size: 16px;
  min-width: 60px;
}

/* 우측 상단 플로팅 버튼들 (세로형) */
#toggle-controls-btn,
#toggle-text-btn,
#opacity-btn
 {
  writing-mode: vertical-rl;
  -webkit-writing-mode: vertical-rl;
  text-orientation: upright;
  -webkit-text-orientation: upright;
  position: fixed;
  right: 10px;
  z-index: 10000;
  padding: 10px 16px;
  font-size: 16px;
  min-width: 20px;
  height: 80px;
}
#toggle-controls-btn { top: 10px; }
#toggle-text-btn { top: 100px; }
#opacity-btn { top: 200px; }

/* 유틸리티 */
#folder-input, #json-input, #zip-input {
  position: absolute;
  width: 0; height: 0; opacity: 0; pointer-events: none;
}
.hidden { display: none; }